const db = require('../models/snipData.js');

const snipController = {};

snipController.addUser = async (req, res, next) => {
  // write code here

  //INSERT INTO people (name, gender, species, yada yada) VALUES ($1, $2, yada yada)
  //RETURNING * (inserting doesn't automatically return anything so we return explicitly here so we can see what we did)
  try {
    const params = [req.body.Username, req.body.password, req.body.sessionID];
    const text =
      'INSERT INTO Persons (Username, password, sessionID) VALUES ($1, $2, $3) RETURNING *';
    const inserted = await db.query(text, params);
    res.locals.newUser = inserted;
    return next();
  } catch (e) {
    return next({ message: 'Error in Add User Middleware' });
  }
};

snipController.addSnip = (req, res, next) => {
  console.log('in add snip');
  try {
    console.log('in add snip');

    res.locals.snipSuccess = req.body.snippet;
    return next();
  } catch (e) {
    return next({ message: 'Error in Add Snip Middleware' });
  }
};

// snipController.addSnip = async (req, res, next) => {
//   try {
//     console.log('in add snip');
//     const params = [req.body.snippet];
//     const text = 'INSERT INTO snippets (snippet) VALUES ($1) RETURNING *';
//     const inserted = await db.query(text, params);
//     res.locals.snipSuccess = inserted;
//     console.log(res.locals.snipSuccess);
//     console.log('user created');
//     return next();
//   } catch (e) {
//     return next({ message: 'Error in Add Snip Middleware' });
//   }
// };

module.exports = snipController;
